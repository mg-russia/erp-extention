
Функция ПолучитьТаблицуШинУстановленныхНаТС(ТС,  Дата = Неопределено, Регистратор = Неопределено) Экспорт
	
	Запрос = Новый Запрос;
	Запрос.Текст = "ВЫБРАТЬ
	|	_ОстаткиШинОстатки.Шина,
	|	_ОстаткиШинОстатки.ТС,
	|	_ОстаткиШинОстатки.МестоУстановки,
	|	_ОстаткиШинОстатки.КоличествоОстаток КАК Количество
	|ИЗ
	|	РегистрНакопления._ОстаткиШин.Остатки(&Дата, ТС = &ТС) КАК _ОстаткиШинОстатки";
	
	Запрос.УстановитьПараметр("ТС", ТС);
	Если НЕ Регистратор = Неопределено  Тогда 
		Запрос.УстановитьПараметр("Дата", Регистратор.МоментВремени());
	ИначеЕсли ЗначениеЗаполнено(Дата) Тогда 
		Запрос.УстановитьПараметр("Дата", Дата);
	Иначе
		Запрос.Текст = СтрЗаменить(Запрос.Текст, "&Дата", "");	
	КонецЕсли;
	
	Возврат Запрос.Выполнить().Выгрузить();
	
КонецФункции

Функция ПолучитьДатуУстановкиШин(ТС, Шина, Дата) Экспорт
	
	Запрос = Новый Запрос;
	Запрос.Текст = "ВЫБРАТЬ ПЕРВЫЕ 1
	|	_ОстаткиШинОбороты.КоличествоПриход,
	|	_ОстаткиШинОбороты.Период КАК ДатаУстановки
	|ИЗ
	|	РегистрНакопления._ОстаткиШин.Обороты(
	|			,
	|			&Дата,
	|			День,
	|			ТС = &ТС
	|				И Шина = &Шина) КАК _ОстаткиШинОбороты
	|
	|СГРУППИРОВАТЬ ПО
	|	_ОстаткиШинОбороты.КоличествоПриход,
	|	_ОстаткиШинОбороты.Период
	|
	|УПОРЯДОЧИТЬ ПО
	|	ДатаУстановки УБЫВ";
	
	Запрос.УстановитьПараметр("ТС", ТС);
	Запрос.УстановитьПараметр("Шина", Шина);
	Запрос.УстановитьПараметр("Дата", Дата);
	
	Результат = Запрос.Выполнить();
	Выборка = Результат.Выбрать();
	Пока Выборка.Следующий() Цикл
		Возврат Выборка.ДатаУстановки;
	КонецЦикла;
	
	Возврат Неопределено;
	
КонецФункции