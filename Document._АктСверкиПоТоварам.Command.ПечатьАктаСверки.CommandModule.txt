
&НаСервере
Функция   ПечатнаяФорма(ПараметрКоманды)
	
	Возврат Документы._АктСверкиПоДоговорамХранения.ПечатьАктСверки(ПараметрКоманды);
	
КонецФункции

&НаСервере
Функция   ПолучитьРеквНаСервере(ИмяРекв, Ссылка)
	
	Если       ИмяРекв = "Контр" Тогда 
		Наименование = Ссылка.Контрагент.НаименованиеПолное;
		Возврат СтрЗаменить(Наименование, Символ(34), "");
	ИначеЕсли  ИмяРекв = "Номер" Тогда
		Возврат ОбщегоНазначения.ПолучитьНомерНаПечать(Ссылка);
	ИначеЕсли  ИмяРекв = "Дата" Тогда 
		Возврат Формат(Ссылка.Дата, "ДФ=dd.MM.yyyy");	
	КонецЕсли;
	
КонецФункции

&НаКлиенте
Процедура ОбработкаКоманды(ПараметрКоманды, ПараметрыВыполненияКоманды)
	
	ТабличныйДокумент = ПечатнаяФорма(ПараметрКоманды);
	
	Если ТабличныйДокумент <> Неопределено Тогда
		Контр = ПолучитьРеквНаСервере("Контр", ПараметрКоманды);
		Номер = ПолучитьРеквНаСервере("Номер", ПараметрКоманды);
		Дата  = ПолучитьРеквНаСервере("Дата", ПараметрКоманды);
		ТабличныйДокумент.Показать("Акт сверки по хранению " + Контр + " №" + Номер + " от " + Дата);
	КонецЕсли;	
	
КонецПроцедуры
